{% extends "catalog/base.html" %}
{% load i18n humanize %}
{% block subtitle %}{{ publisher.name }} - {% endblock %}
{% block content %}
<h1>{{ publisher.name }}</h1>

<h2><a href="{{ publisher.get_absolute_url }}">{{ publisher.name }}</a></h2>
<span class="meta">{% blocktrans with humcount=publisher.publishedgame_set.count|intcomma|apnumber count counter=publisher.publishedgame_set.count %}One Game{% plural %} {{ counter }} Games{% endblocktrans %}, {% blocktrans with humcount=publisher.gamesystem_set.count|intcomma|apnumber count counter=publisher.gamesystem_set.count %}one Game System{% plural %}{{ counter }} Game Systems{% endblocktrans %}, {% blocktrans with humcount=publisher.publishedmodule_set.count|intcomma|apnumber count counter=publisher.publishedmodule_set.count %}and one Game Module{% plural %}and {{ counter }} Game Modules.{% endblocktrans %}</span>
<p>{{ publisher.description }}</p>

<h2>{% trans "Publications" %}</h2>

<ul class="tabs" data-tabs data-deep-link="true" data-deep-link-smudge="true" id="publisher-tabs">
  <li class="tabs-title is-active"><a href="#games_panel" data-tabs-target="games_panel" aria-selected="true">{% trans "Games" %} ({{ publisher.publishedgame_set.count }})</a></li>
  <li class="tabs-title"><a href="#system_panel" data-tab-target="system_panel">{% trans "Game Systems" %} ({{ publisher.gamesystem_set.count }})</a></li>
  <li class="tabs-title"><a href="#module_panel" data-tab-target="module_panel">{% trans "Modules" %} ({{ publisher.publishedmodule_set.count }})</a></li>
</ul>

<div class="tabs-content" data-tabs-content="publisher-tabs">
  <div class="tabs-panel is-active" id="games_panel">
    {% if publisher.publishedgame_set.count %}
    <table class="stack hover">
      <thead>
        <tr>
          <th>{% trans "Title" %}</th>
          <th>{% trans "Edition" %}</th>
          <th>{% trans "System" %}</th>
          <th>{% trans "Published" %}</th>
          <th>{% trans "ISBN" %}</th>
          <th>{% trans "Source" %}</th>
          <th>{% trans "Tagged with" %}</th>
        </tr>
      </thead>
      <tbody>
        {% for game in publisher.publishedgame_set.all %}
        <tr>
          <td><a href="{{ game.get_absolute_url }}">{{ game.title }}</a></td>
          <td>{{ game.edition }}</td>
          <td><a href="{{ game.game_system.get_absolute_url }}">{{ game.game_system.name }}</a></td>
          <td>{{ game.publication_date|date:"Y" }}</td>
          <td>{{ game.isbn }}</td>
          <td>{% if game.url %}<a href="{{ game.url }}" target="_blank">{% trans "Official Page" %}</a>{% endif %}</td>
          <td>{{ game.tags.names|join:", " }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p>{% trans "No games on record from this publisher." %}</p>
    {% endif %}
  </div>
  <div class="tabs-panel" id="system_panel">
    {% if publisher.gamesystem_set.count %}
    <table class="stack hover">
      <thead>
        <tr>
          <th>{% trans "Title" %}</th>
          <th>{% trans "OGL?" %}</th>
          <th>{% trans "Published" %}</th>
          <th>{% trans "Source" %}</th>
          <th>{% trans "Tagged with" %}</th>
        </tr>
      </thead>
      <tbody>
        {% for game in publisher.gamesystem_set.all %}
        <tr>
          <td><a href="{{ game.get_absolute_url }}">{{ game.name }}</a></td>
          <td>{{ game.ogl_license|yesno:"Yes,No" }}</td>
          <td>{{ game.publication_date|date:"Y" }}</td>
          <td>{% if game.url %}<a href="{{ game.url }}" target="_blank">{% trans "Official Page" %}</a>{% endif %}</td>
          <td>{{ game.tags.names|join:", " }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p>{% trans "No game systems on record from this publisher." %}</p>
    {% endif %}
  </div>
  <div class="tabs-panel" id="module_panel">
    {% if publisher.publishedmodule_set.count %}
    <table class="stack hover">
      <thead>
        <tr>
          <th>{% trans "Title" %}</th>
          <th>{% trans "Game" %}</th>
          <th>{% trans "Published" %}</th>
          <th>{% trans "ISBN" %}</th>
          <th>{% trans "Source" %}</th>
          <th>{% trans "Tagged with" %}</th>
        </tr>
      </thead>
      <tbody>
        {% for game in publisher.publishedmodule_set.all %}
        <tr>
          <td><a href="{{ game.get_absolute_url }}">{{ game.title }}</a></td>
          <td><a href="{{ game.parent_game.get_absolute_url }}">{{ game.parent_game.title }}</a></td>
          <td>{{ game.isbn }}</td>
          <td>{{ game.publication_date|date:"Y" }}</td>
          <td>{% if game.url %}<a href="{{ game.url }}" target="_blank">{% trans "Official Page" %}</a>{% endif %}</td>
          <td>{{ game.tags.names|join:", " }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p>{% trans "No published modules on record from this publisher." %}</p>
    {% endif %}
  </div>
</div>

{% endblock %}
